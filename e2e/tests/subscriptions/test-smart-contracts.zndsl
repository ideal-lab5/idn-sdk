Description: Network test
Network: ./zombienet.toml
Creds: config

# Ensure Nodes and Collators are running
alice: is up
bob: is up
idn-alice: is up
idn-bob: is up
idn-consumer-alice: is up
idn-consumer-bob: is up

# Force open HRMP work around due to bug https://www.github.com/paritytech/polkadot-sdk/pull/1616#issuecomment-1727194584 
idn-alice: js-script ../../scripts/setup/set-drand-pubkey.js within 120 seconds
alice: run ../../scripts/setup/open_hrmp.sh within 120 seconds

# Ensure Blocks are being produced, also give enough time to allow for HRMP channels to open
alice: parachain 4502 block height is at least 10 within 6000 seconds
alice: parachain 4594 block height is at least 10 within 6000 seconds

# Fund Sovereign Account
#idn-alice: js-script ../../scripts/setup/balance-transfer.js with "13cKp89N5XAXYWeP2YP13Bq4GVsVdQrhbJSBVeiTKebFrQdF,100000000000000" within 120 seconds
# Pause to allow next transaction to go through+
#sleep 7 seconds
# Fund Treasury Account
#idn-alice: js-script ../../scripts/setup/balance-transfer.js with "1LX9m9Ee8u653hU1sxvvRNpV1ZjYExa7K8r9zjDws9GDLvp,100000000000000" within 120 seconds
#sleep 7 seconds
# Fund Sovereign Account
idn-alice: js-script ../../scripts/setup/balance-transfer.js with "12KKuztzMMCTVR5ox2pDf2jYUusbBRPh458tSBZxuJyw9Aew,100000000000000" within 120 seconds
# Pause to allow next transaction to go through+
sleep 7 seconds
# Fund Treasury Account
idn-alice: js-script ../../scripts/setup/balance-transfer.js with "1L3qBW4xdU2jbz4buXyPpf4zNT1WktKJ2QeXHS7H1yULx6b,100000000000000" within 120 seconds
# Fund Contract Account on IDN
#sleep 7 seconds
#idn-alice: js-script ../../scripts/setup/balance-transfer.js with "5ECDS3goCssRYGSwQvEF8pNJEkFCjA3uE8bazjWfkzvbafw8,100000000000000" within 120 seconds
# Pause to allow next transaction to go through
#sleep 7 seconds
# Fund Contract Account on IDNC
#idn-consumer-alice: js-script ../../scripts/setup/balance-transfer.js with "5ECDS3goCssRYGSwQvEF8pNJEkFCjA3uE8bazjWfkzvbafw8,100000000000000" within 120 seconds
sleep 9000 seconds

# Deploy smart contract to IDNC
idn-consumer-alice: run ../../scripts/setup/deploy_contract.sh within 120 seconds
sleep 9000 seconds